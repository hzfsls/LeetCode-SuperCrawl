## [1517.查找拥有有效邮箱的用户 中文官方题解](https://leetcode.cn/problems/find-users-with-valid-e-mails/solutions/100000/cha-zhao-yong-you-you-xiao-you-xiang-de-gn7ym)
[TOC]

## 解决方案

---

### 概述

给出一个包含用户及其电子邮件的表，我们希望根据用户的电子邮件地址的有效性来筛选用户。一封有效的电子邮件应该以只包含允许字符的前缀开头，以域名 `'@leetcode.com'` 结尾。

---

### 方法 1：使用正则表达式

#### 思路

一般来说，如果你被要求匹配一个字符串，应该最先想到*写一个正则表达式模式进行匹配*。

正则表达式提供各种功能，以下是一些相关功能：

1. `^`：表示一个字符串或行的开头

1. `[a-z]`：表示一个字符范围，匹配从 `a` 到 `z` 的任何字符。

    * `[0-9]`：表示一个字符范围，匹配从 `0` 到 `9` 的任何字符。

    * `[a-zA-Z]`：这个变量匹配从 `a` 到 `z` 或 `A` 到 `Z` 的任何字符。请注意，你可以在方括号内指定的字符范围的数量没有限制，您可以添加想要匹配的其他字符或范围。

    * `[^a-z]`：这个变量匹配不在 `a` 到 `z` 范围内的任何字符。请注意，字符 `^` 用来否定字符范围，它在方括号内的含义与它的方括号外表示开始的含义不同。

1. `[a-z]*`：表示一个字符范围，匹配从 `a` 到 `z` 的任何字符 0 次或多次。

1. `[a-z]+`：表示一个字符范围，匹配从 `a` 到 `z` 的任何字符 1 次或多次。

1. `.`：匹配任意**一个**字符。

1. `\.`：表示句点字符。请注意，反斜杠用于转义句点字符，因为句点字符在正则表达式中具有特殊含义。还要注意，在许多语言中，你需要转义反斜杠本身，因此需要使用`\\.`。

1. `$`：表示一个字符串或行的结尾。

核心思想是将 name 列的第一个字符从其余字符分开，相应地改变它们的大小写，最后把他们拼回在一起。

#### 算法

选择 `mail` 列匹配正则表达式的那些行。

#### 实现

**MySQL**

```sql
SELECT user_id, name, mail
FROM Users
-- 请注意，我们还转义了`@`字符，因为它在某些正则表达式中具有特殊意义
WHERE mail REGEXP '^[a-zA-Z][a-zA-Z0-9_.-]*\\@leetcode\\.com$';
```

**Pandas**

```python3
import pandas as pd

def valid_emails(users: pd.DataFrame) -> pd.DataFrame:
    # 注意我们如何使用原始字符串(在前面放一个‘r’)来避免必须转义反斜杠
    # 还要注意，我们对`@`字符进行了转义，因为它在某些正则表达式中具有特殊意义
    return users[users["mail"].str.match(r"^[a-zA-Z][a-zA-Z0-9_.-]*\@leetcode\.com$")]
```

---