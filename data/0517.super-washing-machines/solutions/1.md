## [517.超级洗衣机 中文热门题解1](https://leetcode.cn/problems/super-washing-machines/solutions/100000/517-chao-ji-xi-yi-ji-zui-da-ci-shu-jiu-s-cqts)

作者：[livorth-u](https://leetcode.cn/u/livorth-u)

## 题目分析

给出一排洗衣机，洗衣机里面有不同数量的衣服

我们需要**将这些衣服平均的分到每个洗衣机里**面去

但是每次只能从一台洗衣机里面取出一件衣服，不能取多了

不过可以同时对多台洗衣机进行操作，就像示例1中的第二步一样，从第二三台洗衣机里分别取出了一件衣服给它们左边的洗衣机。

---

## 解题思路

首先明确一点，**如果衣服不能均分，那么移动是没有意义的**，也就是所有衣服之和不能整除洗衣机数时需要直接返回 -1

我们以`[ 1, 0, 5, 6 ]`为例子

1. 最终我们要得到的状态是`[ 3, 3, 3, 3 ]`
2. 如果将两个做差会得到`[ -2, -3, 2, 3]`，即到达对应位置还需要移动多少件衣服，**负数为移入，正数为移出**
3. 很显然，如果要使第一台洗衣机达到平均数量，那么他需要**从第二台那里要来 2 件**，这时数组变成了`[ 0, -5, 2, 3]`，**移动次数为 2**
4. 然后再使第二台达到平衡，他需要**从第三台那里要来 5 件**，这时数组变成了`[ 0, 0, -3, 3]`，**移动次数为 5**
5. 最后是使第三台达到平衡，他需要**从第四台那里要来 3 件**，这时数组变成了`[ 0, 0, 0, 0]`，**移动次数为 3**

6. 这时会发现，总移动次数为10次，但是这就是最终答案了吗？显然不是，因为虽然我们只能一次移动一件衣服，但是我们可以同时移动多台洗衣机的衣服，所以**移动的最大次数就是使第二台保持平衡时所移动的那5次**，**即`[ -2, -3, 2, 3] `的差值数组中出现的绝对值最大的数字**

---

## 对应代码

```java
class Solution {
    public int findMinMoves(int[] machines) {
        // 先求出总和，然后判断是否能均分
        int sum = 0;
        int len = machines.length;
        for (int i = 0; i < len; i++) {
            sum += machines[i];
        }
        // 不能均分则返回 -1
        if (sum%len != 0) {
            return -1;
        }

        // res：最终结果，balance：当前位置到达平衡所需要移动的次数，avg：平均值
        int res = 0, balance = 0, avg = sum / len;
        for (int i = 0; i < len; i++) {
            // 在前面位全部到达平均的前提下，当前位置达到平衡所需要切换的次数
            balance += machines[i] - avg;
            // 选出变化值最大的一次
            // 仍要考虑machines[i]-avg是因为当前洗衣机可能衣服很多，是一个向两边输出衣服的角色
            // 那么这时最大变化就是machines[i]-avg了
            res = Math.max(res, Math.max(machines[i] - avg, Math.abs(balance)));
        }
        return res;
    }
}
```

